<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <%- include('partials/head') %>
  <body class="list">
    <!-- Header -->
    <%- include('partials/header') %>
    <main class="list">
      <input class="checkbox" type="checkbox" id="check" />
      <label id="menu" class="menu" for="check"
        ><i class="fas fa-bars"></i
      ></label>
      <aside class="aside-list">
        <section class="filter">
          <h4>Filtrar por categoria:</h4>
          <div style="width: 100%">
            <form class="row" action="/products/filter" method="GET">
              <div class="col-9">
                <select
                  name="category"
                  class="form-select"
                  size="<%= categories.length %> "
                >
                  <option value="" selected hidden>Categorias...</option>
                  <% categories.forEach(category => { %>
                  <option value="<%= category.id %>">
                    <%= category.name %>
                  </option>
                  <% }) %>
                </select>
              </div>
              <button class="col-3 btn btn-outline-primary" type="submit">
                Filtrar
              </button>
            </form>
          </div>
        </section>
      </aside>
      <section class="list-body" style="display: block">
        
        <% if (products.length === 0) { %>
            <h3 class="destacado">No se encontraron productos <i class="fa-regular fa-face-frown"></i></h3>
            <% } else{ %>
                <h3 class="destacado">Todos los productos</h3>
                <div class="target-container">
                  <% products.forEach(product => { %>
                  <div class="target">
                    <section class="art">
                      <article class="prod">
                        <a href="/products/detail/<%= product.id %>"
                          ><img src="/images/<%= product.image %>" alt=""
                        /></a>
                        <% if (product.discount > 0) { %>
                          <p class="price"><span><%= product.discount %>% OFF</span> <br> $ <%= calcDescuento(product.price, product.discount) %></p>    
                      <% } else { %>
                          <p class="price">$ <%= product.price %></p>
                      <% } %>
                        <div class="botones">
                          <a
                            class="agregar"
                            href="#"
                            onclick="addItem(event, '<%=product.id%>')"
                            ><i class="fas fa-cart-plus"></i
                          ></a>
                        </div>
                        <div class="detalles-producto">
                          <p class="prod-name"><%= product.name %></p>
                        </div>
                      </article>
                    </section>
                  </div>
                  <% }) %>
                </div>
                <% } %>

      </section>
    </main>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
      crossorigin="anonymous"
    ></script>
  </body>

  <!-- Footer -->
  <%- include('partials/footer') %>
</html>
